"use strict";(()=>{var e={};e.id=625,e.ids=[625],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},71568:e=>{e.exports=require("zlib")},33439:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>R,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>x,serverHooks:()=>h,staticGenerationAsyncStorage:()=>v});var s={};t.r(s),t.d(s,{DELETE:()=>f,GET:()=>l,POST:()=>d,PUT:()=>p,dynamic:()=>c});var o=t(49303),a=t(88716),i=t(60670),n=t(83493),u=t(87070);let c="force-dynamic";async function l(e){try{let r=e.headers.get("x-user-id"),t=e.headers.get("x-user-role"),s=await n._.fuelRecord.findMany({where:"admin"===t?{}:{vehicle:{ownerId:r||void 0}},include:{vehicle:{select:{id:!0,licensePlate:!0,brand:!0,model:!0}}},orderBy:{date:"desc"},take:50});return u.NextResponse.json({success:!0,records:s})}catch(e){return console.error("Error fetching fuel records:",e),u.NextResponse.json({success:!1,error:"Failed to fetch fuel records"},{status:500})}}async function d(e){try{let r=await e.json();if(!r.vehicleId||!r.date||!r.liters||!r.totalCost)return u.NextResponse.json({success:!1,error:"Please provide all required fields"},{status:400});let t=await n._.fuelRecord.create({data:{vehicleId:r.vehicleId,date:new Date(r.date),driver:r.driver,fuelType:r.fuelType,liters:parseFloat(r.liters),pricePerLiter:parseFloat(r.pricePerLiter),totalCost:parseFloat(r.totalCost),remarks:r.remarks,receiptUrl:r.receiptUrl}});return u.NextResponse.json({success:!0,record:t})}catch(e){return console.error("Error creating fuel record:",e),u.NextResponse.json({success:!1,error:"Failed to create record"},{status:500})}}async function p(e){try{let r=await e.json();if(!r.id)return u.NextResponse.json({success:!1,error:"Record ID is required"},{status:400});let t=await n._.fuelRecord.update({where:{id:r.id},data:{date:new Date(r.date),driver:r.driver,fuelType:r.fuelType,liters:parseFloat(r.liters),pricePerLiter:parseFloat(r.pricePerLiter),totalCost:parseFloat(r.totalCost),remarks:r.remarks}});return u.NextResponse.json({success:!0,record:t})}catch(e){return console.error("Error updating fuel record:",e),u.NextResponse.json({success:!1,error:"Failed to update record"},{status:500})}}async function f(e){try{let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return u.NextResponse.json({success:!1,error:"Record ID is required"},{status:400});return await n._.fuelRecord.delete({where:{id:t}}),u.NextResponse.json({success:!0,message:"Record deleted"})}catch(e){return console.error("Error deleting fuel record:",e),u.NextResponse.json({success:!1,error:"Failed to delete record"},{status:500})}}let x=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/fuel/route",pathname:"/api/fuel",filename:"route",bundlePath:"app/api/fuel/route"},resolvedPagePath:"D:\\kendaraan\\app\\api\\fuel\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:v,serverHooks:h}=x,R="/api/fuel/route";function y(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:v})}},83493:(e,r,t)=>{t.d(r,{_:()=>c});let s=require("@prisma/client");var o=t(2351);let a=globalThis,i=process.env.DATABASE_URL;i||console.error("âŒ DATABASE_URL environment variable is not set!");let n=i?.replace("mysql://","mariadb://")?.replace(":@","@"),u=n?new o.N(n):void 0,c=a.prisma??new s.PrismaClient({adapter:u,log:["error"]})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,972,351],()=>t(33439));module.exports=s})();