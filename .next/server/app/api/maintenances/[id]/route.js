"use strict";(()=>{var e={};e.id=53,e.ids=[53],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},71568:e=>{e.exports=require("zlib")},47976:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var n={};r.r(n),r.d(n,{DELETE:()=>l,GET:()=>u,PUT:()=>d});var s=r(49303),a=r(88716),o=r(60670),i=r(83493),c=r(87070);async function u(e,{params:t}){try{let{id:r}=await t,n=e.headers.get("x-user-id"),s=e.headers.get("x-user-role"),a=await i._.maintenance.findUnique({where:{id:r},include:{vehicle:{select:{id:!0,licensePlate:!0,brand:!0,model:!0,ownerId:!0}}}});if(!a)return c.NextResponse.json({success:!1,error:"Maintenance record not found"},{status:404});if("admin"!==s&&a.vehicle.ownerId!==n)return c.NextResponse.json({success:!1,error:"You do not have permission to view this record"},{status:403});return c.NextResponse.json({success:!0,maintenance:a})}catch(e){return console.error("Error fetching maintenance:",e),c.NextResponse.json({success:!1,error:"Failed to fetch maintenance record"},{status:500})}}async function d(e,{params:t}){try{let{id:r}=await t,n=e.headers.get("x-user-id"),s=e.headers.get("x-user-role"),a=await e.json(),o=await i._.maintenance.findUnique({where:{id:r},include:{vehicle:{select:{ownerId:!0}}}});if(!o)return c.NextResponse.json({success:!1,error:"Maintenance record not found"},{status:404});if("admin"!==s&&o.vehicle.ownerId!==n)return c.NextResponse.json({success:!1,error:"You do not have permission to edit this record"},{status:403});let u={};void 0!==a.type&&(u.type=a.type),void 0!==a.description&&(u.description=a.description),void 0!==a.cost&&(u.cost=null!==a.cost?parseFloat(a.cost):null),void 0!==a.mileage&&(u.mileage=null!==a.mileage?parseInt(a.mileage):null),void 0!==a.maintenanceDate&&(u.maintenanceDate=a.maintenanceDate?new Date(a.maintenanceDate):void 0),void 0!==a.nextServiceDate&&(u.nextServiceDate=a.nextServiceDate?new Date(a.nextServiceDate):null),void 0!==a.workshop&&(u.workshop=a.workshop),void 0!==a.technician&&(u.technician=a.technician),void 0!==a.notes&&(u.notes=a.notes),void 0!==a.status&&(u.status=a.status);let d=await i._.maintenance.update({where:{id:r},data:u});return c.NextResponse.json({success:!0,maintenance:d})}catch(e){return console.error("Error updating maintenance:",e),c.NextResponse.json({success:!1,error:"Failed to update maintenance record"},{status:500})}}async function l(e,{params:t}){try{let{id:r}=await t,n=e.headers.get("x-user-id"),s=e.headers.get("x-user-role"),a=await i._.maintenance.findUnique({where:{id:r},include:{vehicle:{select:{ownerId:!0}}}});if(!a)return c.NextResponse.json({success:!1,error:"Maintenance record not found"},{status:404});if("admin"!==s&&a.vehicle.ownerId!==n)return c.NextResponse.json({success:!1,error:"You do not have permission to delete this record"},{status:403});return await i._.maintenance.delete({where:{id:r}}),c.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting maintenance:",e),c.NextResponse.json({success:!1,error:"Failed to delete maintenance record"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/maintenances/[id]/route",pathname:"/api/maintenances/[id]",filename:"route",bundlePath:"app/api/maintenances/[id]/route"},resolvedPagePath:"D:\\kendaraan\\app\\api\\maintenances\\[id]\\route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:x}=p,v="/api/maintenances/[id]/route";function w(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},83493:(e,t,r)=>{r.d(t,{_:()=>u});let n=require("@prisma/client");var s=r(2351);let a=globalThis,o=process.env.DATABASE_URL;o||console.error("âŒ DATABASE_URL environment variable is not set!");let i=o?.replace("mysql://","mariadb://")?.replace(":@","@"),c=i?new s.N(i):void 0,u=a.prisma??new n.PrismaClient({adapter:c,log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972,351],()=>r(47976));module.exports=n})();